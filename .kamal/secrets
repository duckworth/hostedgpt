# Fetch secrets from 1Password
SECRETS=$( kamal secrets fetch --adapter 1password --account my --from DevOps/HostedGPT KAMAL_REGISTRY_PASSWORD RAILS_MASTER_KEY HOSTED_DB_PASSWORD SECRET_KEY_BASE ACTIVE_RECORD_ENCRYPTION_PRIMARY_KEY ACTIVE_RECORD_ENCRYPTION_DETERMINISTIC_KEY ACTIVE_RECORD_ENCRYPTION_KEY_DERIVATION_SALT DEFAULT_ANTHROPIC_KEY DEFAULT_OPENAI_KEY SMTP_USER_NAME SMTP_PASSWORD)
# Extract each secret
KAMAL_REGISTRY_PASSWORD=$(kamal secrets extract KAMAL_REGISTRY_PASSWORD $SECRETS)
RAILS_MASTER_KEY=$(kamal secrets extract RAILS_MASTER_KEY $SECRETS)
HOSTED_DB_PASSWORD=$(kamal secrets extract HOSTED_DB_PASSWORD $SECRETS)
SECRET_KEY_BASE=$(kamal secrets extract SECRET_KEY_BASE $SECRETS)
ACTIVE_RECORD_ENCRYPTION_PRIMARY_KEY=$(kamal secrets extract ACTIVE_RECORD_ENCRYPTION_PRIMARY_KEY $SECRETS)
ACTIVE_RECORD_ENCRYPTION_KEY_DERIVATION_SALT=$(kamal secrets extract ACTIVE_RECORD_ENCRYPTION_KEY_DERIVATION_SALT $SECRETS)
ACTIVE_RECORD_ENCRYPTION_DETERMINISTIC_KEY=$(kamal secrets extract ACTIVE_RECORD_ENCRYPTION_DETERMINISTIC_KEY $SECRETS)
DEFAULT_OPENAI_KEY=$(kamal secrets extract DEFAULT_OPENAI_KEY $SECRETS)
DEFAULT_ANTHROPIC_KEY=$(kamal secrets extract DEFAULT_ANTHROPIC_KEY $SECRETS)
SMTP_USER_NAME=$(kamal secrets extract SMTP_USER_NAME $SECRETS)
SMTP_PASSWORD=$(kamal secrets extract SMTP_PASSWORD $SECRETS)


# Set POSTGRES_PASSWORD to the database password
POSTGRES_PASSWORD=$HOSTED_DB_PASSWORD
